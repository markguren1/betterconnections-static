<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Compatibility - BetterConnections</title>
  <link rel="stylesheet" href="styles.css" />
  <style>
    .grid2 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }
    @media (max-width: 860px) {
      .grid2 { grid-template-columns: 1fr; }
    }
    .note {
      border-left: 6px solid rgba(79,70,229,0.35);
      background: rgba(255,255,255,0.78);
      border: 1px solid var(--border);
      border-left-width: 6px;
      padding: 12px 14px;
      border-radius: 14px;
      box-shadow: var(--shadow);
      color: var(--muted);
    }
    .matrix {
      width: 100%;
      border-collapse: collapse;
      overflow: hidden;
      border-radius: 16px;
      border: 1px solid var(--border);
      background: #fff;
      box-shadow: var(--shadow);
    }
    .matrix th, .matrix td {
      padding: 12px 10px;
      border-bottom: 1px solid rgba(229,231,235,0.85);
      border-right: 1px solid rgba(229,231,235,0.55);
      text-align: center;
      font-size: 14px;
      vertical-align: middle;
    }
    .matrix th:first-child, .matrix td:first-child {
      text-align: left;
      font-weight: 800;
      color: var(--text);
      background: rgba(17,24,39,0.02);
    }
    .matrix th {
      font-weight: 900;
      color: var(--text);
      background: rgba(17,24,39,0.02);
    }
    .chip {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      font-weight: 900;
      font-size: 12px;
      min-width: 78px;
    }
    .best { background: rgba(34,197,94,0.14); border-color: rgba(34,197,94,0.35); }
    .good { background: rgba(59,130,246,0.12); border-color: rgba(59,130,246,0.30); }
    .mixed { background: rgba(245,158,11,0.14); border-color: rgba(245,158,11,0.35); }
    .hard { background: rgba(239,68,68,0.12); border-color: rgba(239,68,68,0.30); }

    .legendRow { display:flex; flex-wrap:wrap; gap:10px; margin-top: 10px; }
    .pairTitle { display:flex; flex-wrap:wrap; align-items:center; gap:10px; margin: 0 0 8px; }
    .selectRow { display:flex; flex-wrap:wrap; gap:10px; align-items:center; margin-top: 10px; }
    select {
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: #fff;
      color: var(--text);
      font-weight: 800;
    }
  </style>
</head>

<body>
  <nav>
    <div class="container">
      <div class="nav-brand">BetterConnections</div>
      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="quiz.html">Personality Quiz</a></li>
        <li><a href="results.html">Results</a></li>
        <li><a href="deep-dive.html">Deep Dive</a></li>
        <li><a class="active" href="compatibility.html">Compatibility</a></li>
        <li><a href="nextgen-assistant.html">NextGen Assistant</a></li>
        <li><a href="application-stories.html">Application Stories</a></li>
        <li><a href="learning-quiz.html">Learning Quiz</a></li>
        <li><a href="wrap-up.html">Wrap-Up</a></li>
      </ul>
    </div>
  </nav>

  <div class="container">
    <h1>Compatibility</h1>
    <p>Some pairings feel effortless. Others create friction — especially under pressure.  
    This framework shows where communication styles naturally align or clash.</p>

    <div class="note">
      <strong>Important:</strong> Your closest relationships (spouses, co-founders, best colleagues) can still show up as “high friction” on paper.  
      This chart explains *why* friction happens and how to reduce it — not who you should work with.
    </div>

    <div id="missing" class="card" style="display:none; margin-top:14px;">
      <h2>No quiz result found</h2>
      <p>Please take the Personality Quiz first so we can personalize your compatibility view.</p>
      <div class="btnRow">
        <a class="button" href="quiz.html">Go to Quiz</a>
      </div>
    </div>

    <div id="main" style="display:none;">

      <div class="card" style="margin-top:14px;">
        <div class="pairTitle">
          <h2 style="margin:0;">Your Type: <span id="yourType" class="pill"></span></h2>
          <span id="yourTag" class="chip"></span>
        </div>

        <p>
          Select the other person’s style to see what tends to work, what creates friction,
          and how to adapt your communication in meetings, interviews, and difficult conversations.
        </p>

        <div class="selectRow">
          <label style="font-weight:900;">Other person:</label>
          <select id="otherSelect"></select>
          <span id="pairChip" class="chip"></span>
        </div>
      </div>

      <div class="card">
        <h2>Best / Worst Match Matrix</h2>
        <p>Rows = you, columns = the other person.</p>

        <table class="matrix">
          <thead>
            <tr>
              <th>You \ Them</th>
              <th>Driver</th>
              <th>Amiable</th>
              <th>Expressive</th>
              <th>Analytical</th>
            </tr>
          </thead>
          <tbody id="matrixBody"></tbody>
        </table>

        <div class="legendRow">
          <span class="chip best">Best</span>
          <span class="chip good">Good</span>
          <span class="chip mixed">Mixed</span>
          <span class="chip hard">High friction</span>
        </div>
      </div>

      <div class="grid2" style="margin-top:14px;">
        <div class="card">
          <h2>What works</h2>
          <p id="works"></p>
        </div>
        <div class="card">
          <h2>Common friction</h2>
          <p id="friction"></p>
        </div>
      </div>

      <div class="grid2" style="margin-top:14px;">
        <div class="card">
          <h2>Do this</h2>
          <p id="doThis"></p>
        </div>
        <div class="card">
          <h2>Avoid this</h2>
          <p id="avoidThis"></p>
        </div>
      </div>

      <div class="card" style="margin-top:14px;">
        <h2>Next step</h2>
        <p>The NextGen Assistant helps you translate personality insight into practical phrasing for emails, interviews, and high-stakes conversations.</p>
        <div class="btnRow">
          <a class="button secondary" href="deep-dive.html">Back to Deep Dive</a>
          <a class="button" href="nextgen-assistant.html">Continue to NextGen Assistant</a>
        </div>
      </div>

    </div>
  </div>

<script>
  const TYPES = ["Driver", "Amiable", "Expressive", "Analytical"];

  function getParam(name) { return new URL(window.location.href).searchParams.get(name); }
  function normalizeType(raw) {
    if (!raw) return null;
    const v = String(raw).trim().toLowerCase();
    if (v === "driver") return "Driver";
    if (v === "amiable") return "Amiable";
    if (v === "expressive") return "Expressive";
    if (v === "analytical") return "Analytical";
    return null;
  }

  const MATRIX = {
    Driver:     { Driver:"mixed", Amiable:"good",  Expressive:"mixed", Analytical:"good"  },
    Amiable:    { Driver:"good",  Amiable:"best",  Expressive:"good",  Analytical:"mixed" },
    Expressive: { Driver:"mixed", Amiable:"good",  Expressive:"best",  Analytical:"hard"  },
    Analytical: { Driver:"good",  Amiable:"mixed", Expressive:"hard",  Analytical:"best"  }
  };

  const LABEL = { best:"Best", good:"Good", mixed:"Mixed", hard:"High friction" };
  const CHIP_CLASS = { best:"best", good:"good", mixed:"mixed", hard:"hard" };

  const PAIRS = {
    "Driver|Driver": { works:"Fast decisions and momentum.", friction:"Power struggles.", doThis:"Define roles and decide quickly.", avoidThis:"Turning everything into a contest." },
    "Driver|Amiable": { works:"Direction + stability.", friction:"Bulldozing vs slowing.", doThis:"Balance speed with empathy.", avoidThis:"Blunt pressure or vague hints." },
    "Driver|Expressive": { works:"Vision + execution.", friction:"Focus vs freedom.", doThis:"Let ideas flow, then lock a plan.", avoidThis:"Shutting ideas down early." },
    "Driver|Analytical": { works:"Speed + quality.", friction:"Rushing vs over-analyzing.", doThis:"Ask for top risks, then decide.", avoidThis:"Dismissing data or forcing speed." },
    "Amiable|Amiable": { works:"Trust and stability.", friction:"Avoiding tough conversations.", doThis:"Name issues early and kindly.", avoidThis:"Silent resentment." },
    "Amiable|Expressive": { works:"Warmth and energy.", friction:"Overwhelm vs boundaries.", doThis:"State needs clearly.", avoidThis:"People-pleasing." },
    "Amiable|Analytical": { works:"Calm + structure.", friction:"Emotion vs logic mismatch.", doThis:"Pair feelings with facts.", avoidThis:"Assuming tone is obvious." },
    "Expressive|Expressive": { works:"Energy and creativity.", friction:"Scattered priorities.", doThis:"Pick one goal and act.", avoidThis:"Endless brainstorming." },
    "Expressive|Analytical": { works:"Big ideas + execution.", friction:"Vibe vs proof.", doThis:"Specify criteria, validate emotion.", avoidThis:"Calling each other cold or dramatic." },
    "Analytical|Analytical": { works:"Quality and consistency.", friction:"Overthinking.", doThis:"Set decision deadlines.", avoidThis:"Analysis paralysis." }
  };

  function getPairKey(a,b){ return a+"|"+b; }
  function pairContent(a,b){
    return PAIRS[getPairKey(a,b)] || PAIRS[getPairKey(b,a)] || {
      works:"This pairing works with awareness.",
      friction:"Different pace and tone.",
      doThis:"Name expectations clearly.",
      avoidThis:"Assuming intent."
    };
  }

  function renderMatrix() {
    const body = document.getElementById("matrixBody");
    body.innerHTML = "";
    for (const you of TYPES) {
      const tr = document.createElement("tr");
      const th = document.createElement("td"); th.textContent = you; tr.appendChild(th);
      for (const them of TYPES) {
        const level = MATRIX[you][them];
        const td = document.createElement("td");
        const chip = document.createElement("span");
        chip.className = `chip ${CHIP_CLASS[level]}`;
        chip.textContent = LABEL[level];
        td.appendChild(chip);
        tr.appendChild(td);
      }
      body.appendChild(tr);
    }
  }

  (function init(){
    let type = normalizeType(getParam("type")) || normalizeType(localStorage.getItem("bc_personality_type"));
    if (!type) { document.getElementById("missing").style.display = "block"; return; }

    document.getElementById("yourType").textContent = type;

    const sel = document.getElementById("otherSelect");
    TYPES.forEach(t => { const o=document.createElement("option"); o.value=t; o.textContent=t; sel.appendChild(o); });

    sel.value = (type==="Expressive")?"Analytical":(type==="Analytical")?"Expressive":(type==="Driver")?"Amiable":"Driver";
    renderMatrix();

    function updatePair() {
      const other = sel.value;
      const level = MATRIX[type][other];
      const setChip = (el, lvl)=>{ el.className=`chip ${CHIP_CLASS[lvl]}`; el.textContent=LABEL[lvl]; };
      setChip(document.getElementById("pairChip"), level);
      setChip(document.getElementById("yourTag"), MATRIX[type][type]);

      const info = pairContent(type, other);
      document.getElementById("works").textContent = info.works;
      document.getElementById("friction").textContent = info.friction;
      document.getElementById("doThis").textContent = info.doThis;
      document.getElementById("avoidThis").textContent = info.avoidThis;
    }

    sel.addEventListener("change", updatePair);
    updatePair();
    document.getElementById("main").style.display = "block";
  })();
</script>
</body>
</html>
