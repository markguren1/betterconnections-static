<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>BetterConnections Results</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <div class="container">

    <div class="flow">
      <span class="step">1) Personality Quiz</span>
      <span class="step current">2) Results</span>
      <span class="step">3) Deep Dive</span>
      <span class="step">4) Compatibility</span>
      <span class="step">5) NextGen Assistant</span>
    </div>

    <h1>Personality Results</h1>
    <p>Your personality type is the foundation for BetterConnections. The bars show your percentage across the four styles.</p>

    <div id="missing" class="card" style="display:none;">
      <h2>No quiz result found</h2>
      <p>Please take the Personality Quiz first.</p>
      <div class="btnRow">
        <a class="button" href="quiz.html">Go to Quiz</a>
      </div>
    </div>

    <div id="main" style="display:none;">

      <div class="card" style="margin-bottom: 14px;">
        <h2>Your Type: <span id="typeLabel" class="pill"></span></h2>
        <p id="summary"></p>

        <div class="btnRow">
          <a class="button secondary" href="quiz.html">Retake Quiz</a>
          <a class="button secondary" href="deep-dive.html">Continue to Deep Dive</a>
          <a class="button secondary" href="compatibility.html">Continue to Compatibility</a>
        </div>
      </div>

      <div class="card" style="margin-bottom: 14px;">
        <h2>Score Bars (Percentages)</h2>
        <div id="bars"></div>
        <p style="margin-top:10px;">Percentages are based on your answers out of 10 questions.</p>
      </div>

      <div class="card" style="margin-bottom: 14px;">
        <h2>Score Breakdown (raw)</h2>
        <pre id="raw"></pre>
      </div>

      <div class="card">
        <h2>Strengths & Challenges</h2>
        <table class="table">
          <tr><th>Strengths</th><td id="strengths"></td></tr>
          <tr><th>Challenges</th><td id="challenges"></td></tr>
          <tr><th>Communication Style</th><td id="comm"></td></tr>
          <tr><th>Under Stress</th><td id="stress"></td></tr>
        </table>
      </div>

    </div>

  </div>

<script>
  const TYPES = ["Driver", "Amiable", "Expressive", "Analytical"];

  const CONTENT = {
    Driver: {
      summary: "Direct, decisive, and goal-focused. You value progress, clarity, and results.",
      strengths: "Decisive • Confident • Action-oriented • Efficient",
      challenges: "Can seem blunt • Impatient • May overlook feelings",
      comm: "Concise, direct, results-focused.",
      stress: "May become controlling or forceful."
    },
    Amiable: {
      summary: "Supportive, steady, and relationship-focused. You value harmony, trust, and cooperation.",
      strengths: "Patient • Loyal • Supportive • Team-oriented",
      challenges: "Avoids conflict • Difficulty saying no • Internalizes stress",
      comm: "Warm, collaborative, reassuring.",
      stress: "May withdraw or people-please."
    },
    Expressive: {
      summary: "Enthusiastic, social, and idea-driven. You value connection, recognition, and inspiration.",
      strengths: "Energetic • Optimistic • Persuasive • Creative",
      challenges: "Impulsive • Misses details • Can overwhelm",
      comm: "Open, animated, big-picture.",
      stress: "May become scattered or dramatic."
    },
    Analytical: {
      summary: "Thoughtful, precise, and logic-focused. You value accuracy, structure, and understanding.",
      strengths: "Logical • Accurate • Prepared • Thorough",
      challenges: "Overthinks • Slow to decide • Can seem detached",
      comm: "Structured, detailed, data-driven.",
      stress: "Analysis paralysis or withdrawal."
    }
  };

  function getParam(name) {
    return new URL(window.location.href).searchParams.get(name);
  }

  function parseJSON(str) {
    try { return JSON.parse(str); } catch { return null; }
  }

  function renderBars(scores) {
    const bars = document.getElementById("bars");
    bars.innerHTML = "";

    const total = TYPES.reduce((sum, t) => sum + Number(scores[t] || 0), 0) || 1;

    for (const t of TYPES) {
      const value = Number(scores[t] || 0);
      const pct = Math.round((value / total) * 100);

      const row = document.createElement("div");
      row.className = "barLine";

      const label = document.createElement("div");
      label.textContent = t;

      const track = document.createElement("div");
      track.className = "track";

      const fill = document.createElement("div");
      fill.className = `fill ${t}`;      // uses .fill.Driver, .fill.Amiable, etc. from styles.css
      fill.style.width = pct + "%";      // percentage width

      track.appendChild(fill);

      const num = document.createElement("div");
      num.textContent = pct + "%";       // show % on the right

      row.appendChild(label);
      row.appendChild(track);
      row.appendChild(num);

      bars.appendChild(row);
    }
  }

  (function init() {
    const type = getParam("type") || localStorage.getItem("bc_personality_type");
    const scores = parseJSON(getParam("scores")) || parseJSON(localStorage.getItem("bc_personality_scores"));

    if (!type || !scores) {
      document.getElementById("missing").style.display = "block";
      return;
    }

    document.getElementById("typeLabel").textContent = type;
    document.getElementById("summary").textContent = CONTENT[type]?.summary || "";
    document.getElementById("strengths").textContent = CONTENT[type]?.strengths || "";
    document.getElementById("challenges").textContent = CONTENT[type]?.challenges || "";
    document.getElementById("comm").textContent = CONTENT[type]?.comm || "";
    document.getElementById("stress").textContent = CONTENT[type]?.stress || "";

    document.getElementById("raw").textContent = JSON.stringify(scores, null, 2);

    renderBars(scores);
    document.getElementById("main").style.display = "block";
  })();
</script>

</body>
</html>
