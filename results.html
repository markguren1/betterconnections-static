<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>BetterConnections Results</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 980px;
      margin: 0 auto;
      padding: 24px;
      background: #ffffff !important;
      color: #111111 !important;
    }

    .flow {
      border: 1px solid #e5e5e5;
      border-radius: 10px;
      padding: 12px 14px;
      margin-bottom: 18px;
      background: #fff;
      font-size: 14px;
    }
    .flow .step {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #ddd;
      margin-right: 6px;
      background: #fafafa;
    }
    .flow .current {
      background: #111;
      color: #fff;
      border-color: #111;
    }

    .card {
      border: 1px solid #e5e5e5;
      border-radius: 12px;
      padding: 18px;
      margin: 14px 0;
      background: #fff;
    }

    .pill {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 999px;
      border: 1px solid #ddd;
      font-weight: 700;
      background: #fafafa;
    }

    .layout {
      display: grid;
      grid-template-columns: 1.3fr 0.7fr;
      gap: 16px;
    }

    .barLine {
      display: grid;
      grid-template-columns: 110px 1fr 40px;
      gap: 10px;
      align-items: center;
      margin: 10px 0;
      font-size: 14px;
    }

    .track {
      height: 12px;
      border-radius: 999px;
      background: #f0f0f0;
      overflow: hidden;
      border: 1px solid #e5e5e5;
    }

    .fill {
      height: 100%;
      width: 0%;
      border-radius: 999px;
    }

    /* COLOR CODING */
    .Driver { background: #e74c3c; }      /* red */
    .Amiable { background: #27ae60; }     /* green */
    .Expressive { background: #f39c12; }  /* orange */
    .Analytical { background: #3498db; }  /* blue */

    pre {
      background: #f5f5f5;
      padding: 10px;
      border-radius: 6px;
      font-size: 13px;
    }

    button, a.button {
      padding: 10px 14px;
      border-radius: 8px;
      border: 1px solid #111;
      background: #111;
      color: #fff;
      font-weight: 700;
      text-decoration: none;
      margin-right: 8px;
      display: inline-block;
    }

    a.secondary {
      background: #fff;
      color: #111;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      font-size: 14px;
    }

    th, td {
      padding: 10px;
      border-bottom: 1px solid #eee;
      text-align: left;
      vertical-align: top;
    }

    th {
      width: 190px;
      color: #333;
    }
  </style>
</head>

<body>

<div class="flow">
  <span class="step">1) Personality Quiz</span>
  <span class="step current">2) Results</span>
  <span class="step">3) Deep Dive</span>
  <span class="step">4) Compatibility</span>
  <span class="step">5) NextGen Assistant</span>
</div>

<h1>Personality Results</h1>
<p>Your personality type is the foundation for BetterConnections.</p>

<div id="missing" class="card" style="display:none;">
  <strong>No quiz result found.</strong>
  <p>Please take the Personality Quiz first.</p>
  <a class="button" href="quiz.html">Go to Quiz</a>
</div>

<div id="main" style="display:none;">

  <div class="layout">
    <div class="card">
      <h2>Your Type: <span id="typeLabel" class="pill"></span></h2>
      <p id="summary"></p>

      <a class="button secondary" href="quiz.html">Retake Quiz</a>
      <a class="button secondary" href="deep-dive.html">Continue to Deep Dive</a>
      <a class="button secondary" href="compatibility.html">Continue to Compatibility</a>

      <div class="card" style="margin-top:16px;">
        <strong>Score Breakdown (raw)</strong>
        <pre id="raw"></pre>
      </div>
    </div>

    <div class="card">
      <strong>Score Bars</strong>
      <div id="bars"></div>
      <p style="font-size:12px;opacity:0.85;margin-top:6px;">
        Color-coded by personality type.
      </p>
    </div>
  </div>

  <div class="card">
    <h3>Strengths & Challenges</h3>
    <table>
      <tr><th>Strengths</th><td id="strengths"></td></tr>
      <tr><th>Challenges</th><td id="challenges"></td></tr>
      <tr><th>Communication Style</th><td id="comm"></td></tr>
      <tr><th>Under Stress</th><td id="stress"></td></tr>
    </table>
  </div>

</div>

<script>
  const TYPES = ["Driver", "Amiable", "Expressive", "Analytical"];

  const CONTENT = {
    Driver: {
      summary: "Direct, decisive, and goal-focused.",
      strengths: "Decisive • Confident • Action-oriented • Efficient",
      challenges: "Can seem blunt • Impatient • May overlook feelings",
      comm: "Concise, direct, results-focused.",
      stress: "May become controlling or forceful."
    },
    Amiable: {
      summary: "Supportive, steady, and relationship-focused.",
      strengths: "Patient • Loyal • Supportive • Team-oriented",
      challenges: "Avoids conflict • Difficulty saying no",
      comm: "Warm, collaborative, reassuring.",
      stress: "May withdraw or people-please."
    },
    Expressive: {
      summary: "Enthusiastic, social, and idea-driven.",
      strengths: "Energetic • Optimistic • Persuasive • Creative",
      challenges: "Impulsive • Misses details • Can overwhelm",
      comm: "Open, animated, big-picture.",
      stress: "May become scattered or dramatic."
    },
    Analytical: {
      summary: "Thoughtful, precise, and logic-focused.",
      strengths: "Logical • Accurate • Prepared • Thorough",
      challenges: "Overthinks • Slow to decide • Rigid",
      comm: "Structured, detailed, data-driven.",
      stress: "Analysis paralysis or withdrawal."
    }
  };

  function parseJSON(str) {
    try { return JSON.parse(str); } catch { return null; }
  }

  function getParam(name) {
    return new URL(window.location.href).searchParams.get(name);
  }

  function renderBars(scores) {
    const container = document.getElementById("bars");
    const max = Math.max(...TYPES.map(t => scores[t])) || 1;
    container.innerHTML = "";

    TYPES.forEach(t => {
      const pct = Math.round((scores[t] / max) * 100);

      const row = document.createElement("div");
      row.className = "barLine";

      const label = document.createElement("div");
      label.textContent = t;

      const track = document.createElement("div");
      track.className = "track";

      const fill = document.createElement("div");
      fill.className = `fill ${t}`;
      fill.style.width = pct + "%";

      track.appendChild(fill);

      const num = document.createElement("div");
      num.textContent = scores[t];

      row.appendChild(label);
      row.appendChild(track);
      row.appendChild(num);

      container.appendChild(row);
    });
  }

  (function init() {
    const type = getParam("type") || localStorage.getItem("bc_personality_type");
    const scores = parseJSON(getParam("scores")) || parseJSON(localStorage.getItem("bc_personality_scores"));

    if (!type || !scores) {
      document.getElementById("missing").style.display = "block";
      return;
    }

    document.getElementById("typeLabel").textContent = type;
    document.getElementById("summary").textContent = CONTENT[type].summary;
    document.getElementById("strengths").textContent = CONTENT[type].strengths;
    document.getElementById("challenges").textContent = CONTENT[type].challenges;
    document.getElementById("comm").textContent = CONTENT[type].comm;
    document.getElementById("stress").textContent = CONTENT[type].stress;
    document.getElementById("raw").textContent = JSON.stringify(scores, null, 2);

    renderBars(scores);
    document.getElementById("main").style.display = "block";
  })();
</script>

</body>
</html>
